%!TEX root = CooperBarba2014.tex

Figure \ref{fig:molecule_surface} shows a system with three types of free energy: Coulombic energy from the point charges, surface energy due to $\Gamma_2$ and solvation energy. The Coulombic energy arises simply from the Coulomb interactions of all point charges. This section describes how we compute the other two components of free energy in the boundary-element framework.

\medskip

\paragraph*{Solvation free energy}

When a protein is in a solvated state, surrounded by water molecules that have become polarized, its free energy differs from its state \emph{in vacuo} by an amount known as the solvation energy. Its free energy again differs in the presence of other structures in the solvent, e.g., other proteins or charged surfaces. In this work we use the term solvation energy to more broadly mean the change in free energy of the protein from its state in a vacuum, to its state in the solvent with any other components or structures. In single-molecule settings, this definition of solvation energy coincides with the energy required to solvate the molecule. 

To calculate the solvation energy, the total minus the Coulomb potential is applied inside the protein, i.e.,

\begin{align} \label{eq:solv_energy}
F_{\text{solv}} &= \frac{1}{2} \int_{\Omega} \rho \,(\phi_{\text{total}} - \phi_{\text{Coulomb}}) \\
&= \sum_{k=0}^{N_q} q_k (\phi_{\text{total}} - \phi_{\text{Coulomb}})(\mathbf{r}_k),
\end{align}

\noindent where $\rho$ is the charge distribution, consisting of point charges (which transforms the integral into a sum). 
The total minus Coulomb potential includes the reaction potential---representing the response of the solvent by polarization and rearrangement of free ions---and any effects from the immersed surface.
We can also interpret it as the potential generated by the boundary $\Gamma$ of the molecular region $\Omega$. Taking the first expression of Equation \eqref{eq:green_identity} and subtracting out the Coulombic effect yields
%
\begin{equation} \label{eq:phi_reac_bem}
\phi_{\text{reac},\mathbf{r}_k} = -K_{L}^{\mathbf{r}_k}(\phi_{1,\Gamma_1}) + V_{L}^{\mathbf{r}_k} \left(\frac{\partial}{\partial \mathbf{n}}\phi_{1,\Gamma_1} \right) 
\end{equation}

Equation \eqref{eq:solv_energy} requires evaluating $\phi_{\text{reac}}$ for each point-charge location $\mathbf{r}_k$. We obtain this by discretizing Equation \eqref{eq:phi_reac_bem} and using the solution of the linear system in Equation \eqref{eq:matrix_phi} or Equation \eqref{eq:matrix_dphi} as inputs.

\medskip
\paragraph*{Surface free energy}

Chan and co-workers \cite{ChanMitchell1983,CarnieChan1993} derived the free energy for a surface with a set charge or potential. They describe the free energy on a surface as

\begin{align} \label{eq:energy_surf}
F &= \frac{1}{2} \int_{\Gamma} G_c \sigma_0^2 d\Gamma \quad \text{ for set charge, and} \nonumber \\
F &= -\frac{1}{2} \int_{\Gamma} G_p \phi_0^2 d\Gamma \quad \text{ for set potential,}
\end{align} 

\noindent where $\phi_0$ and $\sigma_0$ are the prescribed potential and surface charge, respectively. The potential is given by $\phi(\sigma, R, \mathbf{x}) = G_c(R, \mathbf{x}) \sigma$ for the first expression and the surface charge by $\sigma(\phi, R, \mathbf{x}) = G_p(R, \mathbf{x}) \phi$ for the second one. This is valid because we are using a linearized Poisson-Boltzmann model.

Using constant values of $\phi$ and $\frac{\partial \phi}{\partial \mathbf{n}}$ per panel, the discretized version of Equation \eqref{eq:energy_surf} takes the form

\begin{align} \label{eq:energy_surf_disc}
F &= \frac{1}{2} \sum_{j=1}^{N_p} \phi(\mathbf{r}_j) \sigma_{0j} A_j \text{, and } \nonumber \\
F &= -\frac{1}{2} \sum_{j=1}^{N_p} \phi_{0j} \sigma(\mathbf{r}_j) A_j. 
\end{align}

\noindent where $A_j$ is the area of panel $j$, and $\sigma = \epsilon \frac{\partial \phi}{\partial \mathbf{n}}$. To obtain the surface free energy, we can plug in the solution of the system in Equation \eqref{eq:matrix_phi} or \eqref{eq:matrix_dphi} to Equation \eqref{eq:energy_surf_disc}. 

\medskip
\paragraph*{Interaction free energy}
When there are two or more bodies in the solvent, they will interact electrostatic ally. In order to compute the energy of interaction, we need to take the difference between the total energy of the interacting system and the total energy of each isolated component, where the total free energy is given by
%
\begin{equation} \label{eq:total_energy}
F_{\text{total}} = F_{\text{Coulomb}} + F_{\text{surface}} + F_{\text{solv}}.
\end{equation}

\noindent The interaction free energy is
%
\begin{equation} \label{eq:interaction_energy}
F_{\text{interaction}} = F_{\text{total}}^{\text{assembly}} - \sum_{i=1}^{N_c} F_{\text{total}}^{\text{comp}_i},
\end{equation}

\noindent where $N_c$ is the number of components in the system and $F_{\text{total}}^{\text{comp}_i}$ is calculated over the isolated component $i$.